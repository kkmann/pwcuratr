<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting Started • pwcuratr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pwcuratr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/pwcuratr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/kkmann/pwcuratr">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Getting Started</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/kkmann/pwcuratr/blob/master/vignettes/pwcuratr.Rmd"><code>vignettes/pwcuratr.Rmd</code></a></small>
      <div class="hidden name"><code>pwcuratr.Rmd</code></div>

    </div>

    
    
<p>Start by loading <code>pwcuratr</code> and a collection of packages that facilitates data manipulation and plotting.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(pwcuratr)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tidyverse)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co">#&gt; ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ──</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#&gt; ✔ ggplot2 3.2.1     ✔ purrr   0.3.3</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">#&gt; ✔ tibble  2.1.3     ✔ dplyr   0.8.4</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt; ✔ tidyr   1.0.2     ✔ stringr 1.4.0</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#&gt; ✔ readr   1.3.1     ✔ forcats 0.4.0</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt; ✖ dplyr::filter() masks stats::filter()</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt; ✖ dplyr::lag()    masks stats::lag()</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(pander)</a></code></pre></div>
<p>The first step to curating a pathway cluster is to define a set of ‘seed genes’ that are of interest. This set could, e.g., be defined via an extensive literature review. The package <code>pwcuratr</code> comes with a set of genes associated with serotonin neurotransmitter pathways. The list of genes can be loaded via</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">seed_genes &lt;-<span class="st"> </span><span class="kw">read_csv</span>(</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">    <span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata/serotonin_seed_genes.csv"</span>, <span class="dt">package=</span><span class="st">"pwcuratr"</span>),</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">    <span class="dt">col_types =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dt">ensembl_gene_id =</span> <span class="kw">col_character</span>())</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">)<span class="op">$</span>ensembl_gene_id</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(seed_genes)</a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt;  [1] "ENSG00000129167" "ENSG00000132437" "ENSG00000178394" "ENSG00000135312"</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt;  [5] "ENSG00000179546" "ENSG00000102468" "ENSG00000135914" "ENSG00000147246"</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt;  [9] "ENSG00000166736" "ENSG00000149305" "ENSG00000178084" "ENSG00000186090"</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt; [13] "ENSG00000164270" "ENSG00000157219" "ENSG00000158748" "ENSG00000148680"</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt; [17] "ENSG00000189221" "ENSG00000036565" "ENSG00000165646" "ENSG00000108576"</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#&gt; [21] "ENSG00000164638"</span></a></code></pre></div>
<p>Next, external data is used to define a plausible functional neighborhood for genes that are functionally related to any of the seed genes. We start by querying a snapshot of the reactome.org pathway database for any pathways containing at least one of the seed genes.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">tbl_reactome_pathways &lt;-<span class="st"> </span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">    <span class="dt">reactome_pathway_id =</span> <span class="kw"><a href="../reference/query_reactome_pathways.html">query_reactome_pathways</a></span>(seed_genes),</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">    <span class="dt">n_participating_genes =</span> <span class="kw">map_int</span>(</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">        reactome_pathway_id,</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">        <span class="op">~</span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw"><a href="../reference/query_participating_genes.html">query_participating_genes</a></span>(.))</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">    )</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="kw">arrange</span>(n_participating_genes)</a>
<a class="sourceLine" id="cb3-9" data-line-number="9"></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="kw"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span>(tbl_reactome_pathways)</a></code></pre></div>
<table class="table">
<colgroup>
<col width="30%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th align="center">reactome_pathway_id</th>
<th align="center">n_participating_genes</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">R-HSA-5579012</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">R-HSA-141333</td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td align="center">R-HSA-379398</td>
<td align="center">2</td>
</tr>
<tr class="even">
<td align="center">R-HSA-380612</td>
<td align="center">2</td>
</tr>
<tr class="odd">
<td align="center">R-HSA-380615</td>
<td align="center">3</td>
</tr>
<tr class="even">
<td align="center">R-HSA-379397</td>
<td align="center">3</td>
</tr>
<tr class="odd">
<td align="center">R-HSA-209905</td>
<td align="center">4</td>
</tr>
<tr class="even">
<td align="center">R-HSA-140179</td>
<td align="center">4</td>
</tr>
<tr class="odd">
<td align="center">R-HSA-209931</td>
<td align="center">5</td>
</tr>
<tr class="even">
<td align="center">R-HSA-379401</td>
<td align="center">5</td>
</tr>
<tr class="odd">
<td align="center">R-HSA-112311</td>
<td align="center">11</td>
</tr>
<tr class="even">
<td align="center">R-HSA-390666</td>
<td align="center">12</td>
</tr>
<tr class="odd">
<td align="center">R-HSA-83936</td>
<td align="center">12</td>
</tr>
<tr class="even">
<td align="center">R-HSA-209776</td>
<td align="center">18</td>
</tr>
<tr class="odd">
<td align="center">R-HSA-181429</td>
<td align="center">18</td>
</tr>
<tr class="even">
<td align="center">R-HSA-181430</td>
<td align="center">18</td>
</tr>
<tr class="odd">
<td align="center">R-HSA-442660</td>
<td align="center">20</td>
</tr>
<tr class="even">
<td align="center">R-HSA-212676</td>
<td align="center">23</td>
</tr>
<tr class="odd">
<td align="center">R-HSA-5579029</td>
<td align="center">42</td>
</tr>
<tr class="even">
<td align="center">R-HSA-375280</td>
<td align="center">43</td>
</tr>
<tr class="odd">
<td align="center">R-HSA-425397</td>
<td align="center">44</td>
</tr>
<tr class="even">
<td align="center">R-HSA-112310</td>
<td align="center">51</td>
</tr>
<tr class="odd">
<td align="center">R-HSA-425366</td>
<td align="center">100</td>
</tr>
<tr class="even">
<td align="center">R-HSA-5668914</td>
<td align="center">111</td>
</tr>
<tr class="odd">
<td align="center">R-HSA-211945</td>
<td align="center">112</td>
</tr>
<tr class="even">
<td align="center">R-HSA-6785807</td>
<td align="center">123</td>
</tr>
<tr class="odd">
<td align="center">R-HSA-112314</td>
<td align="center">220</td>
</tr>
<tr class="even">
<td align="center">R-HSA-416476</td>
<td align="center">223</td>
</tr>
<tr class="odd">
<td align="center">R-HSA-211859</td>
<td align="center">233</td>
</tr>
<tr class="even">
<td align="center">R-HSA-425407</td>
<td align="center">269</td>
</tr>
<tr class="odd">
<td align="center">R-HSA-112315</td>
<td align="center">287</td>
</tr>
<tr class="even">
<td align="center">R-HSA-373076</td>
<td align="center">347</td>
</tr>
<tr class="odd">
<td align="center">R-HSA-71291</td>
<td align="center">412</td>
</tr>
<tr class="even">
<td align="center">R-HSA-112316</td>
<td align="center">438</td>
</tr>
<tr class="odd">
<td align="center">R-HSA-418594</td>
<td align="center">458</td>
</tr>
<tr class="even">
<td align="center">R-HSA-449147</td>
<td align="center">512</td>
</tr>
<tr class="odd">
<td align="center">R-HSA-500792</td>
<td align="center">513</td>
</tr>
<tr class="even">
<td align="center">R-HSA-418555</td>
<td align="center">656</td>
</tr>
<tr class="odd">
<td align="center">R-HSA-382551</td>
<td align="center">806</td>
</tr>
<tr class="even">
<td align="center">R-HSA-1280215</td>
<td align="center">1024</td>
</tr>
<tr class="odd">
<td align="center">R-HSA-388396</td>
<td align="center">1290</td>
</tr>
<tr class="even">
<td align="center">R-HSA-1643685</td>
<td align="center">1304</td>
</tr>
<tr class="odd">
<td align="center">R-HSA-372790</td>
<td align="center">1370</td>
</tr>
<tr class="even">
<td align="center">R-HSA-1430728</td>
<td align="center">2291</td>
</tr>
<tr class="odd">
<td align="center">R-HSA-168256</td>
<td align="center">2734</td>
</tr>
<tr class="even">
<td align="center">R-HSA-162582</td>
<td align="center">3105</td>
</tr>
</tbody>
</table>
<p>A naive approach to defining a function neighborhood for the seed genes would be to take the union of all genes who are participating in any of the identified reactome pathways. However, reactome.org pathways are defined on very different levels of granularity and it will not always be sensible to include all participating genes from very large pathways. A first step to address this ‘specificity problem’ is to hand-curate the list of pathways to consider for further processing. Here, a completely arbitrary cut-off in terms of the pathway size of 250 participating genes is chosen. To avoid loosing any of the seed genes, they are added manually to the initial list of candidate genes.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">candidate_genes &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">    <span class="kw"><a href="../reference/query_participating_genes.html">query_participating_genes</a></span>(</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">        tbl_reactome_pathways <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="st">            </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(n_participating_genes <span class="op">&lt;=</span><span class="st"> </span><span class="dv">250</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="st">            </span><span class="kw">pull</span>(reactome_pathway_id)</a>
<a class="sourceLine" id="cb4-6" data-line-number="6">    ),</a>
<a class="sourceLine" id="cb4-7" data-line-number="7">    seed_genes</a>
<a class="sourceLine" id="cb4-8" data-line-number="8">) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9">unique</a>
<a class="sourceLine" id="cb4-10" data-line-number="10"></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(candidate_genes)</a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt; [1] 1059</span></a></code></pre></div>
<p>To refine the candidate set of genes even further, predicted functional gene-gene interactions based on the 2018 release of the interactions derived in</p>
<blockquote>
<p>Wu, G., Feng, X., &amp; Stein, L. (2010). A human functional protein interaction network and its application to cancer data analysis. Genome biology, 11(5), R53.</p>
</blockquote>
<p>are used. The set of interactions is scored between 0 (low confidence) and 1 (high confidence) for functional interaction between the respective genes.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">tbl_reactome_interactions <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="st">    </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="st">    </span><span class="kw">aes</span>(score) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">.01</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">"Confidence score distribution for functional interactions"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="st">    </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="pwcuratr_files/figure-html/unnamed-chunk-5-1.png" width="720"></p>
<p>Clearly, the majority of included interactions has a confidence score of 0.9 or greater and we filter the set of interactions with this threshold. This results in a gene interaction network that can be used to refine our notion of functional neighborhood. We want to filter the set of candidate genes derived above such that only genes that are connected to a seed gene via at most <span class="math inline">\(k\)</span> edges are retained.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">    <span class="dt">maxedgedistance =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">10</span>,</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">    <span class="dt">n_genes_pruned  =</span> <span class="kw">map_int</span>(</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">        maxedgedistance,</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">        <span class="op">~</span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw"><a href="../reference/prune.html">prune</a></span>(</a>
<a class="sourceLine" id="cb6-6" data-line-number="6">            candidate_genes, </a>
<a class="sourceLine" id="cb6-7" data-line-number="7">            seed_genes, </a>
<a class="sourceLine" id="cb6-8" data-line-number="8">            <span class="dt">minscore        =</span> <span class="fl">.9</span>, </a>
<a class="sourceLine" id="cb6-9" data-line-number="9">            <span class="dt">maxedgedistance =</span> .</a>
<a class="sourceLine" id="cb6-10" data-line-number="10">        ))</a>
<a class="sourceLine" id="cb6-11" data-line-number="11">    )</a>
<a class="sourceLine" id="cb6-12" data-line-number="12">) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="st">    </span><span class="kw">aes</span>(maxedgedistance, n_genes_pruned) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17"><span class="st">    </span><span class="kw">scale_y_continuous</span>(</a>
<a class="sourceLine" id="cb6-18" data-line-number="18">        <span class="st">"number of retained genes"</span>,</a>
<a class="sourceLine" id="cb6-19" data-line-number="19">        <span class="dt">limits =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(0L, <span class="ot">NA_integer_</span>)</a>
<a class="sourceLine" id="cb6-20" data-line-number="20">    ) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-21" data-line-number="21"><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="st">"maximal edge distance"</span>, <span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">10</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-22" data-line-number="22"><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">"Number of retained candiate genes by choice of maximal edge-distance (k)"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-23" data-line-number="23"><span class="st">    </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-24" data-line-number="24"><span class="st">    </span><span class="kw">theme</span>(</a>
<a class="sourceLine" id="cb6-25" data-line-number="25">        <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>()</a>
<a class="sourceLine" id="cb6-26" data-line-number="26">    )</a></code></pre></div>
<p><img src="pwcuratr_files/figure-html/unnamed-chunk-6-1.png" width="720"></p>
<p>The final choice of <span class="math inline">\(k\)</span> can only be justified by manually inspecting the resulting gene-networks. As an example, consider the choice <span class="math inline">\(k=2\)</span>. We first prune the set of candidate genes and then create an igraph object to represent the network information. This allows us to use the wealth of graph-based techniques implemented in <code>igraph</code> package. For instance, one may be interested in the number of connected components of the pruned gene network.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">candidate_genes &lt;-<span class="st"> </span><span class="kw"><a href="../reference/prune.html">prune</a></span>(</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">    candidate_genes, </a>
<a class="sourceLine" id="cb7-3" data-line-number="3">    seed_genes, </a>
<a class="sourceLine" id="cb7-4" data-line-number="4">    <span class="dt">minscore        =</span> <span class="fl">.9</span>, </a>
<a class="sourceLine" id="cb7-5" data-line-number="5">    <span class="dt">maxedgedistance =</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6">) </a>
<a class="sourceLine" id="cb7-7" data-line-number="7"></a>
<a class="sourceLine" id="cb7-8" data-line-number="8">gr &lt;-<span class="st"> </span><span class="kw"><a href="../reference/as_igraph.html">as_igraph</a></span>(candidate_genes, <span class="dt">minscore =</span> <span class="fl">.9</span>)</a>
<a class="sourceLine" id="cb7-9" data-line-number="9"></a>
<a class="sourceLine" id="cb7-10" data-line-number="10">igraph<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/igraph/man/components.html">components</a></span>(gr)<span class="op">$</span>csize</a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt; [1] 360   5   2   1   1   1   1</span></a></code></pre></div>
<p>There are 7 components with almost all candidate genes connected in the first components and two small non-trivial components. All components of size 1 correspond to seed genes for which no functional neighbors in the selected reactome.org pathways where found.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="../reference/plot-gene-network.html">plot_pathway</a></span>(</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">    candidate_genes, </a>
<a class="sourceLine" id="cb8-3" data-line-number="3">    seed_genes, </a>
<a class="sourceLine" id="cb8-4" data-line-number="4">    <span class="dt">minscore  =</span> <span class="fl">0.9</span>, </a>
<a class="sourceLine" id="cb8-5" data-line-number="5">    <span class="dt">titlesize =</span> <span class="dv">20</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6">)</a></code></pre></div>
<p><img src="pwcuratr_files/figure-html/unnamed-chunk-8-1.png" width="1152"></p>
<p>Based on this visual representation, the neighborhood parameters could be tweaked or the set of initial reactome pathways could be altered. In the presence of non-connected components it might be worthwhile considering a split of the pathway cluster such that each individual network is fully connected.</p>
<p>For instance, one could consider the HTR subsystem separately by restricting the initial set of seed genes. Since the HTR3 subsystem is not connected, we can filter these seed genes out as well.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">seed_genes_htr &lt;-<span class="st"> </span>tbl_ensembl <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="st">    </span><span class="kw">select</span>(external_gene_name, ensembl_gene_id) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="st">    </span><span class="kw">distinct</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="st">    </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">        ensembl_gene_id <span class="op">%in%</span><span class="st"> </span>seed_genes, </a>
<a class="sourceLine" id="cb9-6" data-line-number="6">        <span class="kw">str_detect</span>(external_gene_name, <span class="st">"HTR[^3]"</span>)</a>
<a class="sourceLine" id="cb9-7" data-line-number="7">    ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="st">    </span><span class="kw">pull</span>(ensembl_gene_id) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="st">    </span><span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>()</a>
<a class="sourceLine" id="cb9-10" data-line-number="10"></a>
<a class="sourceLine" id="cb9-11" data-line-number="11">tbl_reactome_pathways_htr &lt;-<span class="st"> </span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb9-12" data-line-number="12">        <span class="dt">reactome_pathway_id =</span> <span class="kw"><a href="../reference/query_reactome_pathways.html">query_reactome_pathways</a></span>(seed_genes_htr),</a>
<a class="sourceLine" id="cb9-13" data-line-number="13">        <span class="dt">n_participating_genes =</span> <span class="kw">map_int</span>(</a>
<a class="sourceLine" id="cb9-14" data-line-number="14">            reactome_pathway_id,</a>
<a class="sourceLine" id="cb9-15" data-line-number="15">            <span class="op">~</span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="kw"><a href="../reference/query_participating_genes.html">query_participating_genes</a></span>(.))</a>
<a class="sourceLine" id="cb9-16" data-line-number="16">        )</a>
<a class="sourceLine" id="cb9-17" data-line-number="17">    ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-18" data-line-number="18"><span class="st">    </span><span class="kw">arrange</span>(n_participating_genes)</a>
<a class="sourceLine" id="cb9-19" data-line-number="19"></a>
<a class="sourceLine" id="cb9-20" data-line-number="20">candidate_genes_htr &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(</a>
<a class="sourceLine" id="cb9-21" data-line-number="21">        <span class="kw"><a href="../reference/query_participating_genes.html">query_participating_genes</a></span>(</a>
<a class="sourceLine" id="cb9-22" data-line-number="22">            tbl_reactome_pathways_htr <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-23" data-line-number="23"><span class="st">                </span><span class="kw"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span>(n_participating_genes <span class="op">&lt;=</span><span class="st"> </span><span class="dv">250</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-24" data-line-number="24"><span class="st">                </span><span class="kw">pull</span>(reactome_pathway_id)</a>
<a class="sourceLine" id="cb9-25" data-line-number="25">        ),</a>
<a class="sourceLine" id="cb9-26" data-line-number="26">        seed_genes_htr</a>
<a class="sourceLine" id="cb9-27" data-line-number="27">    ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-28" data-line-number="28"><span class="st">    </span>unique <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-29" data-line-number="29"><span class="st">    </span><span class="kw"><a href="../reference/prune.html">prune</a></span>(</a>
<a class="sourceLine" id="cb9-30" data-line-number="30">        seed_genes_htr, </a>
<a class="sourceLine" id="cb9-31" data-line-number="31">        <span class="dt">minscore        =</span> <span class="fl">.9</span>, </a>
<a class="sourceLine" id="cb9-32" data-line-number="32">        <span class="dt">maxedgedistance =</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb9-33" data-line-number="33">    ) </a>
<a class="sourceLine" id="cb9-34" data-line-number="34"></a>
<a class="sourceLine" id="cb9-35" data-line-number="35">gr &lt;-<span class="st"> </span><span class="kw"><a href="../reference/as_igraph.html">as_igraph</a></span>(candidate_genes_htr, <span class="dt">minscore =</span> <span class="fl">.9</span>)</a>
<a class="sourceLine" id="cb9-36" data-line-number="36"></a>
<a class="sourceLine" id="cb9-37" data-line-number="37">igraph<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/igraph/man/components.html">components</a></span>(gr)<span class="op">$</span>csize</a>
<a class="sourceLine" id="cb9-38" data-line-number="38"><span class="co">#&gt; [1] 216</span></a></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="../reference/plot-gene-network.html">plot_graph</a></span>(</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">    gr, </a>
<a class="sourceLine" id="cb10-3" data-line-number="3">    seed_genes,</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">    <span class="dt">titlesize =</span> <span class="dv">20</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5">)</a></code></pre></div>
<p><img src="pwcuratr_files/figure-html/unnamed-chunk-10-1.png" width="1152"></p>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Kevin Kunzmann.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
